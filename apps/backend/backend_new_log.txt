INFO:     Will watch for changes in these directories: ['/Users/kevz/Documents/GitHub/rpm/RPM-1.3/apps/backend']
INFO:     Uvicorn running on http://127.0.0.1:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [49331] using WatchFiles
INFO:     Started server process [49333]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
/Users/kevz/RPM 1.3/.venv/lib/python3.11/site-packages/sqlalchemy_redshift/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution, parse_version
2025-08-06 16:24:50,932 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-08-06 16:24:50,933 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-08-06 16:24:50,955 INFO sqlalchemy.engine.Engine select current_schema()
2025-08-06 16:24:50,955 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-08-06 16:24:50,990 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-06 16:24:50,990 INFO sqlalchemy.engine.Engine 
            SELECT 
                site as site_id,
                site_name,
                state as location,
                ac_capacity_poi_limited as capacity_kw,
                cod_date as installation_date,
                'active' as status,
                CASE 
                    -- Sites that were in your Python script are likely active
                    WHEN site IN ('ASMB1', 'ASMB2', 'ASMB3', 'IRIS1', 'STJM1') THEN 'connected'
                    -- Sites with recent installation dates (within 2 years) might be active
                    WHEN cod_date > CURRENT_DATE - INTERVAL '2 years' THEN 'connected'
                    -- All others are likely disconnected
                    ELSE 'disconnected'
                END as connectivity_status
            FROM analytics.site_metadata
            WHERE site IS NOT NULL
            ORDER BY site_name ASC
        
2025-08-06 16:24:50,990 INFO sqlalchemy.engine.Engine [dialect redshift+psycopg2 does not support caching 0.00016s] {}
2025-08-06 16:24:51,020 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:51195 - "POST /api/query HTTP/1.1" 200 OK
2025-08-06 16:25:10,214 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-06 16:25:10,215 INFO sqlalchemy.engine.Engine 
            SELECT 
                site as site_id,
                site_name,
                state as location,
                ac_capacity_poi_limited as capacity_kw,
                cod_date as installation_date,
                'active' as status,
                CASE 
                    -- Sites that were in your Python script are likely active
                    WHEN site IN ('ASMB1', 'ASMB2', 'ASMB3', 'IRIS1', 'STJM1') THEN 'connected'
                    -- Sites with recent installation dates (within 2 years) might be active
                    WHEN cod_date > CURRENT_DATE - INTERVAL '2 years' THEN 'connected'
                    -- All others are likely disconnected
                    ELSE 'disconnected'
                END as connectivity_status
            FROM analytics.site_metadata
            WHERE site IS NOT NULL
            ORDER BY site_name ASC
        
2025-08-06 16:25:10,215 INFO sqlalchemy.engine.Engine [dialect redshift+psycopg2 does not support caching 0.00095s] {}
2025-08-06 16:25:10,241 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:51234 - "POST /api/query HTTP/1.1" 200 OK
2025-08-06 16:28:47,515 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-06 16:28:47,516 INFO sqlalchemy.engine.Engine 
            SELECT 
                site as site_id,
                site_name,
                state as location,
                ac_capacity_poi_limited as capacity_kw,
                cod_date as installation_date,
                'active' as status,
                CASE 
                    -- Sites that were in your Python script are likely active
                    WHEN site IN ('ASMB1', 'ASMB2', 'ASMB3', 'IRIS1', 'STJM1') THEN 'connected'
                    -- Sites with recent installation dates (within 2 years) might be active
                    WHEN cod_date > CURRENT_DATE - INTERVAL '2 years' THEN 'connected'
                    -- All others are likely disconnected
                    ELSE 'disconnected'
                END as connectivity_status
            FROM analytics.site_metadata
            WHERE site IS NOT NULL
            ORDER BY site_name ASC
        
2025-08-06 16:28:47,517 INFO sqlalchemy.engine.Engine [dialect redshift+psycopg2 does not support caching 0.00225s] {}
2025-08-06 16:28:47,544 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:51458 - "POST /api/query HTTP/1.1" 400 Bad Request
WARNING:  WatchFiles detected changes in 'src/api/ai.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [49333]
INFO:     Started server process [51413]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
/Users/kevz/RPM 1.3/.venv/lib/python3.11/site-packages/sqlalchemy_redshift/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution, parse_version
2025-08-06 16:29:58,826 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-08-06 16:29:58,826 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-08-06 16:29:58,852 INFO sqlalchemy.engine.Engine select current_schema()
2025-08-06 16:29:58,852 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-08-06 16:29:58,890 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-06 16:29:58,890 INFO sqlalchemy.engine.Engine 
            SELECT 
                site as site_id,
                site_name,
                state as location,
                ac_capacity_poi_limited as capacity_kw,
                cod_date as installation_date,
                'active' as status,
                CASE 
                    -- Sites that were in your Python script are likely active
                    WHEN site IN ('ASMB1', 'ASMB2', 'ASMB3', 'IRIS1', 'STJM1') THEN 'connected'
                    -- Sites with recent installation dates (within 2 years) might be active
                    WHEN cod_date > CURRENT_DATE - INTERVAL '2 years' THEN 'connected'
                    -- All others are likely disconnected
                    ELSE 'disconnected'
                END as connectivity_status
            FROM analytics.site_metadata
            WHERE site IS NOT NULL
            ORDER BY site_name ASC
        
2025-08-06 16:29:58,890 INFO sqlalchemy.engine.Engine [dialect redshift+psycopg2 does not support caching 0.00041s] {}
2025-08-06 16:29:58,923 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:51582 - "POST /api/query HTTP/1.1" 200 OK
2025-08-06 16:30:15,136 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-06 16:30:15,136 INFO sqlalchemy.engine.Engine 
            SELECT 
                site as site_id,
                site_name,
                state as location,
                ac_capacity_poi_limited as capacity_kw,
                cod_date as installation_date,
                'active' as status,
                CASE 
                    -- Sites that were in your Python script are likely active
                    WHEN site IN ('ASMB1', 'ASMB2', 'ASMB3', 'IRIS1', 'STJM1') THEN 'connected'
                    -- Sites with recent installation dates (within 2 years) might be active
                    WHEN cod_date > CURRENT_DATE - INTERVAL '2 years' THEN 'connected'
                    -- All others are likely disconnected
                    ELSE 'disconnected'
                END as connectivity_status
            FROM analytics.site_metadata
            WHERE site IS NOT NULL
            ORDER BY site_name ASC
        
2025-08-06 16:30:15,137 INFO sqlalchemy.engine.Engine [dialect redshift+psycopg2 does not support caching 0.00099s] {}
2025-08-06 16:30:15,165 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:51616 - "POST /api/query HTTP/1.1" 200 OK
2025-08-06 16:44:58,138 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-06 16:44:58,138 INFO sqlalchemy.engine.Engine 
            SELECT 
                site as site_id,
                site_name,
                state as location,
                ac_capacity_poi_limited as capacity_kw,
                cod_date as installation_date,
                'active' as status,
                CASE 
                    -- Sites that were in your Python script are likely active
                    WHEN site IN ('ASMB1', 'ASMB2', 'ASMB3', 'IRIS1', 'STJM1') THEN 'connected'
                    -- Sites with recent installation dates (within 2 years) might be active
                    WHEN cod_date > CURRENT_DATE - INTERVAL '2 years' THEN 'connected'
                    -- All others are likely disconnected
                    ELSE 'disconnected'
                END as connectivity_status
            FROM analytics.site_metadata
            WHERE site IS NOT NULL
            ORDER BY site_name ASC
        
2025-08-06 16:44:58,138 INFO sqlalchemy.engine.Engine [dialect redshift+psycopg2 does not support caching 0.00092s] {}
2025-08-06 16:44:58,174 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:52475 - "POST /api/query HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_ai_direct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [51413]
INFO:     Started server process [7437]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_ai_direct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [7437]
INFO:     Started server process [7727]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [7727]
INFO:     Started server process [8053]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [8053]
INFO:     Started server process [8352]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [8352]
INFO:     Started server process [8744]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [8744]
INFO:     Started server process [9005]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9005]
INFO:     Started server process [9050]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9050]
INFO:     Started server process [9111]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9111]
INFO:     Started server process [9402]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9402]
INFO:     Started server process [9712]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9712]
INFO:     Started server process [10480]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [10480]
INFO:     Started server process [10529]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [10529]
INFO:     Started server process [10566]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [10566]
INFO:     Started server process [10970]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [10970]
INFO:     Started server process [11008]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11008]
INFO:     Started server process [11045]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_ai_direct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11045]
INFO:     Started server process [11273]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11273]
INFO:     Started server process [49658]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [49658]
INFO:     Started server process [51830]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [51830]
INFO:     Started server process [52037]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/services/ai_service_v2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [52037]
INFO:     Started server process [53797]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
